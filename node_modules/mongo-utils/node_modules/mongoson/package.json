{
  "name": "mongoson",
  "description": "Stringifies query objects for pasting into the Mongo shell.",
  "keywords": [
    "mongodb",
    "json",
    "serializer",
    "stringify",
    "ObjectId",
    "ISODate",
    "DBRef"
  ],
  "version": "0.1.3",
  "directories": {
    "lib": "./lib"
  },
  "main": "lib/mson.js",
  "dependencies": {
    "bson": "0.1.x"
  },
  "devDependencies": {
    "coffee-script": "1.6.x"
  },
  "engines": {
    "node": "0.10.x",
    "npm": "1.2.x"
  },
  "optionalDependencies": {},
  "author": {
    "name": "Meryn Stol",
    "email": "merynstol@gmail.com"
  },
  "homepage": "https://github.com/meryn/mongoson",
  "repository": {
    "type": "git",
    "url": "git://github.com/meryn/mongoson.git"
  },
  "scripts": {
    "prepublish": "npm test",
    "pretest": "cake build",
    "test": "coffee ./test/mson.coffee"
  },
  "readme": "# mongoson: MongoDB Shell Object Notation [![Build Status](https://travis-ci.org/meryn/mongoson.png?branch=master)](https://travis-ci.org/meryn/mongoson)\n\n`MSON.stringify` is an alternative for `JSON.stringify`. It serializes queries (and data to be inserted or updated) in such a way that they can be pasted into the Mongo shell, with no loss of information. ObjectIds, DBRefs and Dates are not converted to strings, so they'll keep working. \n\nThe primary use case is to help with debugging MongoDB queries that are generated by your app.\n\n## Installation\n\n```\nnpm install mongoson\n```\n\n## Usage\n\n### MSON.stringify\n\n```coffee\nMSON = require 'mongoson'\nMSON.stringify mongoQuery\n```\n\nThis returns a serialized query, a \"query object literal\" if you will. The result can be pasted into the mongo console.\n\n#### Notes\n\n* `MSON.stringify` encodes ObjectId, DBRef and Date objects. All else should be equivalent to regular JSON. \n* Passing a replacer function as second argument is not supported.\n* Indentention is not supported.\n\n### MSON.parseUnsafe\n\nFor the brave-at-heart, there's also `MSON.parseUnsafe serializedQuery`. It's called `parseUnsafe` for a reason, because it actually uses `eval` to instantiate the correct `ObjectId`, `DBRef` and `Date` objects, *without doing any sanitation beforehand*. You do NOT want to use this unattended. Before running it on any serialized query, I recommend scrutinizing it for any fishy stuff inside. _It could absolutely execute any kind of code in node.js._\n\nThe advantage of `MSON.parseUnsafe` over doing eval yourself is that the code gets evaluated in a context where `ObjectId`, `DBRef`, and `ISODate` functions are defined. This is quicker than importing them from MongoDB's BSON module yourself.\n\nI'd appreciate any hints on how to adjust (for example) the [JSON2](https://github.com/douglascrockford/JSON-js) parse function to let the specific calls to `ObjectId`, `DBRef` and `ISODate` pass through, while disallowing any other kinds of expressions (beyond valid JSON expressions, obviously). Then we could have a safe `MSON.parse`.\n\n## Example\n\nSuppose you have build a query using some \"native\" Mongo object types (DBRef and ObjectId), like so:\n\n```coffee\nbson = require 'bson'\nObjectID = bson.BSONPure.ObjectID\nDBRef = bson.BSONPure.DBRef\n\nsomeQuery = \n  _id: ObjectID(\"507f1f77bcf86cd799439011\")\n  title: \"Super\"\n  related: [\n    ObjectID(\"507f1f77bcf86cd799439011\"), \n    ObjectID(\"507f1f77bcf86cd799439012\"), \n    ObjectID(\"507f1f77bcf86cd799439013\")\n  ]\n  owner: DBRef(\"groups\",ObjectID(\"507f191e810c19729de860ea\"))\n  updatedAt: \n    $gte: new Date \"2012-02-07T18:32:42.692Z\" \n    $lte: new Date \"2013-02-07T18:32:42.692Z\"\n```\n\nYou can then do\n\n```coffee\nMSON = require 'mongoson'\nconsole.log MSON.stringify someQuery\n```\n\nWhich gives\n\n```javascript\n{\"_id\":ObjectId(\"507f1f77bcf86cd799439011\"),\"title\":\"Super\",\"related\":[ObjectId(\"507f1f77bcf86cd799439011\"),ObjectId(\"507f1f77bcf86cd799439012\"),ObjectId(\"507f1f77bcf86cd799439013\")],\"owner\":{\"$ref\":\"groups\",\"$id\":\"507f191e810c19729de860ea\"},\"updatedAt\":{\"$gte\":ISODate(\"2012-02-07T18:32:42.692Z\"),\"$lte\":ISODate(\"2013-02-07T18:32:42.692Z\")}}\n```\n\nThis is ready to be pasted into the MongoDB shell as part of a command.\n\nThe example input and output is taken straight from the (sole) test for this module, so the above should absolutely work.\n\n## License\n\nmongoson is released under the [MIT License](http://opensource.org/licenses/MIT).  \nCopyright (c) 2013 Meryn Stol",
  "readmeFilename": "README.md",
  "bugs": {
    "url": "https://github.com/meryn/mongoson/issues"
  },
  "_id": "mongoson@0.1.3",
  "dist": {
    "shasum": "5c9ae16b42d35b2e7dc12d14f10e41c1c6b87ca7"
  },
  "_from": "mongoson@0.1.x",
  "_resolved": "https://registry.npmjs.org/mongoson/-/mongoson-0.1.3.tgz"
}
